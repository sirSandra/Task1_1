# Задание №1
- В одном из банков **внедрена новая frontend-система** для работы с клиентами и **обновлена база данных**.
  - Большая часть данных была успешно **перенесена из старых БД в новую централизованную БД**.
  - Во время переключения систем возникли **непредвиденные проблемы в ETL-процессе**, и данные за период **конец 2017 - начало 2018 года** остались в старой базе.
  - Старая база была **отключена**, а не выгруженные данные **сохранены в csv-файлах**.
- Недавно возникла необходимость **построения отчёта по форме 101**, включая данные, оставшиеся в **csv-файлах**.
  - Из-за **архитектурных и управленческих сложностей**, загрузка данных в новую БД **невозможна**.
  - Необходимо **рассчитать витрину отдельно**, но для этого сначала нужно **загрузить исходные данные из csv-файлов в детальный слой (DS)** хранилища в СУБД **Oracle / PostgreSQL**.

## Задача 1.1
- **Разработать ETL-процесс** для загрузки "банковских" данных из **csv-файлов** в соответствующие таблицы СУБД **Oracle** или **PostgreSQL**.
  - Покрыть процесс **логированием этапов работы** и всевозможной **дополнительной статистикой** (на усмотрение вашей фантазии).
  - В исходных файлах могут быть **ошибки в виде некорректных форматов значений**. Однако, анализируя эти значения, можно понять, какие значения имеются в виду.

## Исходные данные:
Данные из 6 таблиц в виде excel-файлов:
- **md_ledger_account_s**: Справочник балансовых счётов.
- **md_account_d**: Информация о счетах клиентов.
- **ft_balance_f**: Остатки средств на счетах.
- **ft_posting_f**: Проводки (движения средств) по счетам.
- **md_currency_d**: Справочник валют.
- **md_exchange_rate_d**: Курсы валют.
    
Файл «Структура таблиц.docx» – поможет создать таблицы в детальном слое DS.

## Требования к реализации задачи:
- Создать в своей БД **пользователя / схему "DS"**.
  - Примеры команд можно найти здесь:
    - [Oracle DBA Schemas Basics](https://oracle-dba.ru/docs/architecture/schemas/basics    - [PostgreSQL Create Schema](https://postgrespro.ru/docs/postgresql/9.6/sql-createschema- В схеме **DS** создать таблицы для загрузки данных из **csv-файлов**.

- **Логирование начала и окончания работы процесса загрузки данных** должно выполняться в специальную логовую таблицу, которую нужно разработать самостоятельно.

- После логирования начала загрузки **добавить таймер (паузу) на 5 секунд**, чтобы была видна разница во времени между началом и окончанием загрузки.

- Для хранения логов создать в БД **отдельного пользователя / схему "LOGS"** и в этой схеме таблицу для логов.

- В случае реализации процесса в **Talend**, в зависимости от мощностей рабочей станции, сделать загрузку из всех файлов **одним потоком в параллели** или **отдельными потоками**.

- Для обновления данных в таблицах детального слоя DS выбрать **правильную Update strategy** и использовать следующие **первичные ключи** для таблиц фактов, измерений и справочников:


| Таблица                | Первичный ключ                           |
|------------------------|------------------------------------------|
| `DS.FT_BALANCE_F`      | `ON_DATE`, `ACCOUNT_RK`                  |
| `DS.FT_POSTING_F`      | `OPER_DATE`, `CREDIT_ACCOUNT_RK`, `DEBET_ACCOUNT_RK` |
| `DS.MD_ACCOUNT_D`      | `DATA_ACTUAL_DATE`, `ACCOUNT_RK`         |
| `DS.MD_CURRENCY_D`     | `CURRENCY_RK`, `DATA_ACTUAL_DATE`        |
| `DS.MD_EXCHANGE_RATE_D`| `DATA_ACTUAL_DATE`, `CURRENCY_RK`        |
| `DS.MD_LEDGER_ACCOUNT_S`| `LEDGER_ACCOUNT`, `START_DATE`          |


## Технологические требования
- **Talend**
  - Бесплатная ETL-платформа, доступная для учебных целей.

- **Python**
  - Язык программирования с множеством библиотек, включая те, что предназначены для работы с базами данных и файлами.

- **Java / Scala**
  - Языки программирования с разнообразными методами работы с базами данных и файлами.

- **Airflow** *(необязательный)*
  - Инструмент для оркестрации процесса загрузки данных. Если вы сможете самостоятельно освоить, установить и использовать Airflow, это будет считаться дополнительным преимуществом.


## Требования к демонстрации работы:
- **Записать видео с экрана компьютера**, в котором вы демонстрируете и комментируете в слух, то что вы делаете или уже разработали.
- **Демонстрация создания или комментирование разработанного ETL-процесса**; подробно прокомментировать каждый шаг.
- **Показать работу потока**: убедиться, что до запуска потока в таблице `DS.ft_balance_f` не было записей, затем запустить поток и показать, что таблица наполнилась.
- **Режим записи в таблицы**: "Запись или замена". Не забудьте определить ключевые поля для обновления информации по уже существующим записям.
- **Демонстрация изменения баланса**: в файле `ft_balance_f.csv` измените баланс для какого-нибудь `<account_rk>`, покажите, что в таблице `DS.ft_balance_f` сначала была одна сумма у этого `<account_rk>`, затем запустите ETL-процесс и покажите, что сумма в таблице обновилась.
- **Загрузка видео в облако**: загрузите видео на гугл-диск, яндекс-диск и т.д. и предоставьте доступ по ссылке.
- **Приложение к домашнему заданию**: внутри архива приложите текстовый файл с ссылкой на ваше видео и все скрипты решения. В случае работы в Talend, выгрузите и прикрепите поток.
